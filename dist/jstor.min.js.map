{"version":3,"sources":["../src/index.js","../src/utils.js"],"names":[],"mappings":"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","file":"jstor.min.js","sourcesContent":["import { updateSubscribers, removeElementFromArray } from './utils'\n\nexport default class Store {\n    constructor(initialValues = {}) {\n        this.addMultipleProps(initialValues)\n    }\n\n    _values = {}\n    _subscribers = []\n    _propSubscribers = {}\n\n    get values() { return { ...this._values } }\n\n    get props() { return Object.keys(this._values) }\n\n    addProp = (prop, value) => {\n        if(this.hasOwnProperty(prop)) throw 'attempted to create duplicate prop'\n        this._values[prop] = value\n        Object.defineProperty(this, prop, {\n            get() {\n                return this._values[prop]\n            },\n            set(value) {\n                this._values[prop] = value\n                if(this._propSubscribers[prop]) updateSubscribers(this._propSubscribers[prop], value)\n                updateSubscribers(this._subscribers, this.values)\n            },\n            enumerable: true,\n            configurable: true\n        })\n    }\n\n    addMultipleProps = values => {\n        for(let prop in values){\n            this.addProp(prop, values[prop])\n        }\n    }\n\n    removeProp = prop => {\n        if(!this.hasOwnProperty(prop)) trow `${prop} doesnt exist in {${this.props.join(', ')}}`\n        delete this._values[prop]\n        delete this._propSubscribers[prop]\n        updateSubscribers(this._propSubscribers[prop], null)\n        updateSubscribers(this._subscribers, this.values)\n    }\n\n    updateMultiple = values => {\n        for(let prop in values){\n            let newValue = values[prop]\n            this._values[prop] = newValue\n            if(this._propSubscribers[prop]) updateSubscribers(this._propSubscribers[prop], newValue)\n        }\n        updateSubscribers(this._subscribers, this.values)\n    }\n\n    subscribe = subscriber => {\n        if (!subscriber) throw 'must suply subscriber'\n        let newSubscriber = !this._subscribers.includes(subscriber)\n        if (newSubscriber) this._subscribers.push(subscriber)\n    }\n\n    unsubscribe = subscriber => {\n        removeElementFromArray(subscriber, this._subscribers)\n    }\n\n    on = (prop, subscriber) => {\n        if (!prop || !subscriber) throw 'must suply prop name and callback'\n        if (!this.hasOwnProperty(prop)) throw `${prop} doesn't exist in {${this.props.join(', ')}}`\n        if (!this._propSubscribers[prop]) this._propSubscribers[prop] = []\n\n        let newSubscriber = !this._propSubscribers[prop].includes(subscriber)\n        if (newSubscriber) this._propSubscribers[prop].push(subscriber)\n    }\n\n    off = (prop, subscriber) => {\n        if (!prop && !subscriber) throw 'must suply prop name and callback'\n        removeElementFromArray(subscriber, this._propSubscribers[prop])\n        if (!this._propSubscribers[prop].length) delete this._propSubscribers[prop]\n    }\n\n    one = (prop, subscriber) => {\n        let oneTimeSubscriber = value => {\n            this.off(prop, oneTimeSubscriber)\n            subscriber(value)\n        }\n        this.on(prop, oneTimeSubscriber)\n    }\n}","function _makeAsync(func){\n    setTimeout(func, 0)\n}\n\nexport function updateSubscribers(subscribers, updates) {\n    if (subscribers.length) subscribers.forEach(subscriber => _makeAsync(_=>subscriber(updates)))\n}\n\nexport function removeElementFromArray(element, array){\n    let elementIndex = array.indexOf(element)\n    if (elementIndex > -1) array.splice(elementIndex, 1)\n}"]}